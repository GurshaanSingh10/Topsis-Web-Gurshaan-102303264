<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TOPSIS Web Tool | Gurshaan Bajwa (102303264)</title>

<style>
body{
    margin:0;
    padding:0;
    font-family: 'Segoe UI', sans-serif;
    background: radial-gradient(circle at top, #0f2027, #203a43, #2c5364);
    height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    color:#fff;
}

.container{
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(12px);
    padding:35px 40px;
    border-radius:16px;
    width:380px;
    box-shadow:0 20px 50px rgba(0,0,0,0.4);
    border:1px solid rgba(255,255,255,0.2);
}

h2{
    text-align:center;
    margin-bottom:6px;
    letter-spacing:1px;
}

.subtitle{
    text-align:center;
    font-size:13px;
    opacity:0.8;
    margin-bottom:25px;
}

label{
    font-weight:600;
    display:block;
    margin-top:14px;
    font-size:14px;
}

input{
    width:100%;
    padding:10px;
    margin-top:6px;
    border-radius:8px;
    border:none;
    outline:none;
    background: rgba(255,255,255,0.85);
    font-size:14px;
}

button{
    width:100%;
    margin-top:24px;
    padding:12px;
    border:none;
    border-radius:10px;
    background: linear-gradient(135deg, #ff512f, #dd2476);
    color:#fff;
    font-size:16px;
    font-weight:600;
    cursor:pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

button:hover{
    transform: translateY(-2px);
    box-shadow:0 10px 25px rgba(0,0,0,0.3);
}
</style>
</head>

<body>

<div class="container">
    <h2>TOPSIS Web Tool</h2>
    <div class="subtitle">Gurshaan Bajwa â€¢ Roll No: 102303264</div>

    <label>Upload CSV File</label>
    <input type="file" id="file">

    <label>Weights (comma separated)</label>
    <input id="weights" value="1,1,1,1">

    <label>Impacts (+ or -)</label>
    <input id="impacts" value="+,+,-,+">

    <button onclick="run()">Generate Result</button>
</div>

<script>
function run(){
    const file = document.getElementById("file").files[0];
    if(!file){ alert("Upload CSV file"); return; }

    const reader = new FileReader();
    reader.onload = function(e){
        const rows = e.target.result.trim().split("\n").map(r=>r.split(","));
        const header = rows[0];
        const data = rows.slice(1);

        const w = document.getElementById("weights").value.split(",").map(Number);
        const imp = document.getElementById("impacts").value.split(",");

        let m = data.map(r=>r.slice(1).map(Number));

        let norm=[];
        for(let j=0;j<m[0].length;j++){
            let s=0; for(let i=0;i<m.length;i++) s+=m[i][j]*m[i][j];
            norm.push(Math.sqrt(s));
        }

        let weighted = m.map(r=>r.map((v,j)=>v/norm[j]*w[j]));

        let best=[], worst=[];
        for(let j=0;j<imp.length;j++){
            let col = weighted.map(r=>r[j]);
            if(imp[j]==="+"){ best.push(Math.max(...col)); worst.push(Math.min(...col)); }
            else{ best.push(Math.min(...col)); worst.push(Math.max(...col)); }
        }

        let score = weighted.map(r=>{
            let d1=0,d2=0;
            for(let j=0;j<r.length;j++){
                d1+=(r[j]-best[j])**2;
                d2+=(r[j]-worst[j])**2;
            }
            return Math.sqrt(d2)/(Math.sqrt(d1)+Math.sqrt(d2));
        });

        let rank=[...score].map((v,i)=>[v,i]).sort((a,b)=>b[0]-a[0]).map((x,i)=>[x[1],i+1]);

        let out = header.join(",")+",Topsis Score,Rank\n";
        data.forEach((r,i)=>{
            out+=r.join(",")+","+score[i]+","+rank.find(x=>x[0]==i)[1]+"\n";
        });

        const blob = new Blob([out],{type:"text/csv"});
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "result.csv";
        a.click();
    };
    reader.readAsText(file);
}
</script>

</body>
</html>
